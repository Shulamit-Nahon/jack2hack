new_func := proc(name, defined) is
	defined := if defined then true else false fi

	local func := [
		'name' ~ name,
		'dependancies' ~ {},
		'asm' ~ '',
		'defined' ~ defined
	]

	proc func@@calls(other) is
		insert other.name into self.dependancies
	end

	proc func@@out(line) is
		self.asm &:= if line = null then '' else line fi & '\n'
	end

	return func
end